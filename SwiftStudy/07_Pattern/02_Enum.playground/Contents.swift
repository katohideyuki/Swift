import UIKit

// 7-2 åˆ—æŒ™å‹

/**
 -----------------------------------------------------------------
 â–  ã‚·ãƒ³ãƒ—ãƒ«ãªåˆ—æŒ™å‹
 ã‚±ãƒ¼ã‚¹åã¯å°æ–‡å­—é–‹å§‹ã®ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ã§è¨˜è¿°ã™ã‚‹ã€‚åˆ—æŒ™å‹ã®åå‰ã¨ã€Œ.ã€ã§è¨˜è¿°ã™ã‚‹ã€‚
 ä»£å…¥å…ˆã®å‹ãŒåˆ—æŒ™å‹ã§ã‚ã‚‹ã¨æ˜ç¢ºãªã‚‰ã€Œ.ã€ã ã‘ã§è¨˜è¿°ã§ãã‚‹ã€‚
 -----------------------------------------------------------------
 */
ã‚·ãƒ³ãƒ—ãƒ«ãªåˆ—æŒ™å‹: do {
    enum Direction {
        case up
        case down
        case right
        case left
    }

    let d = Direction.up
    var x: Direction = .right                     // ä»£å…¥å…ˆãŒDirectionåˆ—æŒ™å‹ã¨æ˜ç¢ºã ã‹ã‚‰ã€Œ.ã€ã®æ›¸ãæ–¹ãŒã§ãã‚‹
    print("upã¨rightã¯ç•°ãªã‚‹ã‚ˆ ğŸ‘‰ \(d == x)")       // false

    ã“ã®æ›¸ãæ–¹ã§ã‚‚ã‚ˆã„: do {
        enum Direction {
            case up, down, right, left
        }
//        let d = .down   // ã“ã®æ›¸ãæ–¹ã§ã¯å¤‰æ•°ã®å‹ãŒæ˜ç¢ºã§ã¯ãªã„ã‹ã‚‰ã€Œ.ã€ã®æ›¸ãæ–¹ã¯ã§ããªã„
        let d: Direction = .down
        let x: Direction = .down
        print("ã“ã‚Œã¯ç­‰ã—ã„ã‚ˆ ğŸ‘‰ \(d == x)")        // true
    }
}

/**
 -----------------------------------------------------------------
 â–  ãƒ¡ã‚½ãƒƒãƒ‰å®šç¾©
 åˆ—æŒ™å‹ã®ã‚±ãƒ¼ã‚¹ã¨ãã‚Œã«ä¾å­˜ã—ãŸæ‰‹ç¶šãã‚’ä¸€ä½“ã®ã‚‚ã®ã¨ã—ã¦å®šç¾©ã™ã‚‹
 -----------------------------------------------------------------
 */
åˆ—æŒ™å‹ã‚’ä½¿ã£ãŸãƒ¡ã‚½ãƒƒãƒ‰: do {
    enum Direction {
        case up, down, right, left

        /// æ™‚è¨ˆå›ã‚Šã§90Â°å›è»¢ã™ã‚‹
        /// - Returns: æ™‚è¨ˆå›ã‚Šã§90Â°å›è»¢ã—ãŸå‘ã
        func clockwise() -> Direction {
            // enumã§è‡ªåˆ†è‡ªèº«ã‚’ä½¿ã†ã‹ã‚‰selfã«ã™ã‚‹
            switch self {
                case .up:    return .right
                case .down:  return .left
                case .right: return .down
                case .left:  return .up
            }
        }
    }

    // æ¤œè¨¼
    let d = Direction.up
    print("upã‚’90Â°ã«æ™‚è¨ˆå‘¨ã‚Šã—ãŸå ´åˆã¯ã€rightã ã‹ã‚‰false ğŸ‘‰ \(d.clockwise() == Direction.down)")                    // false
    // ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ï¼Ÿã¨è¨€ã†ã®ã‹åˆ†ã‹ã‚‰ãªã„ã‘ã©ã€ãã‚Œã¨åŒã˜ã‚ˆã†ãªã“ã¨ãŒã§ãã¦ã„ã‚‹ã€‚
    print("upã‚’2å›90Â°ã«æ™‚è¨ˆå‘¨ã‚Šã—ãŸå ´åˆã¯ã€downã ã‹ã‚‰true ğŸ‘‰ \(d.clockwise().clockwise() == Direction.down)")       //true
}

/**
 -----------------------------------------------------------------
 â–  å€¤å‹ã®åˆ—æŒ™å‹
 åˆ—æŒ™å‹ã®æ–¹ã‚’`å®Ÿä½“å‹`ã¨å‘¼ã¶ã€‚ã¾ãŸå„ã‚±ãƒ¼ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸå€¤ã‚’`å®Ÿä½“å€¤`ã¨å‘¼ã¶ã€‚
 å€¤å‹ã®åˆ—æŒ™å‹ã«è¨˜è¿°ã§ãã‚‹ã®ã¯`æ•´æ•°ã€å®Ÿæ•°ã€Boolå€¤ã€æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«`ã®ã¿ã€‚
 å®Ÿä½“å‹ãŒæ•´æ•°ã®å ´åˆã€ãƒªãƒ†ãƒ©ãƒ«ã§å€¤ã‚’æŒ‡å®šã—ãªã‹ã£ãŸã‚±ãƒ¼ã‚¹ã¯ã€ï¼‘ã¤å‰ã®ã‚±ãƒ¼ã‚¹ã®å€¤ã«`+1`
 ã—ãŸå€¤ã¨ãªã‚‹ã€‚
 -----------------------------------------------------------------
 */
enumã®å‹ãŒIntã®ã¨ã_å€¤ã‚’æŒ‡å®šã—ãªã‹ã£ãŸã‚‰å‰ã®ã‚±ãƒ¼ã‚¹: do {
    enum Direction: Int {
        case up = 0, down/* 1 */, right/* 2 */, left/* 3 */
    }
    let a = Direction.right
    let b = a.rawValue                  // 2
    let c = Direction.down.rawValue     // 1

    å®Ÿä½“å€¤ã‹ã‚‰ãã‚Œã«å¯¾å¿œã™ã‚‹åˆ—æŒ™å‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å–å¾—: do {
        let b: Direction? = Direction(rawValue: 3)
        print("å®Ÿä½“å€¤ãŒ3ã®åˆ—æŒ™å‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯leftã ã‹ã‚‰trueã«ãªã‚‹ã‚ˆ ğŸ‘‰ \(b! == Direction.left)")         // true
        if let c = Direction(rawValue: 2) {
            print("å®Ÿä½“å€¤2ã®åˆ—æŒ™å‹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å–å¾—ã—ã¦ã€ãã®å€¤ã‚’å‡ºåŠ› ğŸ‘‰ \(c.rawValue)")                  // 2
        }
    }
}

// ãƒ—ãƒ­ãƒˆã‚³ãƒ«CaseIterableã‚’æ¡ç”¨ã™ã‚‹ã¨ã€åˆ—æŒ™å‹.allCasesãƒ¡ã‚½ãƒƒãƒ‰ã§åˆ—æŒ™å‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’é…åˆ—ã§å–å¾—ã§ãã‚‹
é–¢æ•°lockwiseã‚’æ”¹è‰¯ã—ã¦ã¿ã‚‹: do {
    enum Direction: Int, CaseIterable {
        case up = 0, right, down, left
        /// æ™‚è¨ˆå›ã‚Šã§90Â°å›è»¢ã™ã‚‹ â€»switchæ–‡ã§ã™ã¹ã¦ã‚’åˆ—æŒ™ã™ã‚‹å¿…è¦ãŒãªããªã£ãŸ
        /// - Returns: è¨ˆå›ã‚Šã§90Â°å›è»¢ã—ãŸå‘ã
        func clockwise() -> Direction {
            let t = (self.rawValue + 1) % 4     // selfã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹è‡ªä½“
            return Direction(rawValue: t)!      // nilã«ãªã‚‰ãªã„
        }
    }

    for e in Direction.allCases {
        print("\(e)ã‚’90Â°ã—ãŸã‚‰ ğŸ‘‰ \(e.clockwise())")
    }
}

/**
 -----------------------------------------------------------------
 â–  åˆ—æŒ™å‹ã«å¯¾ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
 åˆ—æŒ™å‹ã«å®šç¾©ã§ãã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯`è¨ˆç®—å‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ã¿`ã€‚
 -----------------------------------------------------------------
 */
mutatingå±æ€§ã‚’æŒã¤åˆ—æŒ™å‹ã®ãƒ¡ã‚½ãƒƒãƒ‰: do {
    enum Direction: Int {
        case up = 0, right, down, left      // æ™‚è¨ˆå›ã‚Š

        /// å®Ÿä½“å€¤ãŒå³ãŒå·¦ã®æ°´å¹³æ–¹å‘ãªã‚‰ã°true
        var horizontal: Bool {
            switch self {
                case .right, .left: return true
                default: return false
            }
        }
        // æŒ¯ã‚Šè¿”ã‚Šãƒ¡ãƒ¢: mutating â‡¨ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å†…å®¹ã‚’å¤‰æ›´ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰
        /// è‡ªåˆ†è‡ªèº«ã®æ­£åå¯¾ã«ã™ã‚‹
        mutating func turnBack() {
            self = Direction(rawValue: ((self.rawValue + 2) % 4))!
        }
    }
    // æ¤œè¨¼
    var d = Direction.left
    print("ã„ã¾ã¯leftã ã‹ã‚‰å®Ÿä½“å€¤ã¯3 ğŸ‘‰ \(d.rawValue)")                 // 3
    d.turnBack()
    print("leftã‹ã‚‰rightã«å¤‰ã‚ã£ãŸã‹ã‚‰å®Ÿä½“å€¤ã¯1 ğŸ‘‰ \(d.rawValue)")       // 1
    print("ã„ã¾ã¯rightã ã‹ã‚‰trueã«ãªã‚‹ã‚ˆ ğŸ‘‰ \(d.horizontal)")           // true
}

/**
 -----------------------------------------------------------------
 â–  åˆ—æŒ™å‹ã®ã‚¤ãƒ‹ã‚·ãƒ£ãƒ©ã‚¤ã‚¶ã¨ã‚¿ã‚¤ãƒ—ãƒ¡ã‚½ãƒƒãƒ‰
 åˆ—æŒ™å‹ã«ã‚‚ã€æ§‹é€ ä½“ã¨åŒã˜ãã‚¿ã‚¤ãƒ—ãƒ¡ã‚½ãƒƒãƒ‰ã€ã‚¿ã‚¤ãƒ—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€ã‚¤ãƒ‹ã‚·ãƒ£ãƒ©ã‚¤ã‚¶ã‚’å®šç¾©ã™
 ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰`static`ã‚’ã¤ã‘ã‚Œã°ã‚ˆã„ã ã‘ã€‚
 ã‚¤ãƒ‹ã‚·ãƒ£ãƒ©ã‚¤ã‚¶ã§ã¯ã€`selfï¼ˆè‡ªåˆ†è‡ªèº«)`ã«ä½•ã‚’ä»£å…¥ã™ã‚‹ã‹ã€‚ã¨ã„ã†ã“ã¨ã«ãªã‚‹ã€‚
 -----------------------------------------------------------------
 */
ã‚¿ã‚¤ãƒ—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ã‚¤ãƒ‹ã‚·ãƒ£ãƒ©ã‚¤ã‚¶: do {
    enum Direction: Int {
        case up = 0, right, down, left
        static var defaultDirection = Direction.up      // å¤‰æ›´å¯èƒ½ãªåˆæœŸå€¤ â€»æ„å‘³ã‚ã‚‹?
        // åˆæœŸå€¤ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã•ã‚ŒãŸDirectionã‚’è¿”å´ã™ã‚‹
        init() {
            self = .defaultDirection
        }
    }

    // æ¤œè¨¼
    let beforeVal = Direction()
    print("å¤‰æ›´å‰ã®åˆæœŸå€¤ ğŸ‘‰ \(beforeVal)")                // up

    // åˆæœŸå€¤ã‚’å¤‰æ›´(right)
    Direction.defaultDirection = .right
    let e = Direction()
    print("å¤‰æ›´å¾Œã®åˆæœŸå€¤ ğŸ‘‰ \(e)")                        // right

    // gã¯nilã‹ã‚‚ã—ã‚Œãªã„ã‹ã‚‰ if let
    let g = Direction(rawValue: 1)
    if let val = g { print("å®Ÿä½“å€¤ã‚’å…ƒã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã•ã‚ŒãŸDirection ğŸ‘‰ \(val)")}      // right
}
